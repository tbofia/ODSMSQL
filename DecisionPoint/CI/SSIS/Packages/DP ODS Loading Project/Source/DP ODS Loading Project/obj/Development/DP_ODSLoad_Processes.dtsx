<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/15/2016 12:05:21 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="TB101541"
  DTS:CreatorName="CORP\tb101541"
  DTS:DelayValidation="True"
  DTS:DTSID="{8F3ED3E2-F9CF-4E62-845A-5E15F7C6ED07}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.68"
  DTS:LocaleID="1033"
  DTS:MaxConcurrentExecutables="100"
  DTS:ObjectName="DP_ODSLoad_Processes"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="482"
  DTS:VersionGUID="{FD28BB7F-8421-404E-837D-D37DD7B17F93}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[Target]"
      DTS:CreationName="OLEDB"
      DTS:DelayValidation="True"
      DTS:DTSID="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
      DTS:ObjectName="Target">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Package::TargetDatabase]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Package::TargetServer]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=QSQL104NTV;Initial Catalog=AcsOds;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{F80E4176-0444-4738-87DE-DFA89DBD0309}"
      DTS:ObjectName="CustomerDatabase">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">MMedical_QBE</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{42082F40-285A-43DD-8BDB-2E29548F1B85}"
      DTS:ObjectName="CustomerId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">82</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{ECE36608-CDA8-4074-B757-3B5549BEF78B}"
      DTS:ObjectName="DataExtractTypeId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{A75843E9-0FED-4B5A-AC1C-06B474414528}"
      DTS:ObjectName="DataRepositoryPath">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">\\MEDPD-DELL20.corp.int\OdsFileExtracts\</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{F294F01E-3C95-4E22-B42C-CAE89AD8725A}"
      DTS:ObjectName="OdsVersion">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">1.0.0.0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{F2D0EB64-EA0C-4B26-AB99-FC5EA8FE8F20}"
      DTS:ObjectName="OltpPostingGroupAudutId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{7B493070-AA3B-415C-9A6A-6D0B3D136C06}"
      DTS:ObjectName="SnapshotDate">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">1900-01-01 00:00:00.000</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{E20AD2E4-DC09-4DC5-82C7-B46EED69B7CD}"
      DTS:ObjectName="TargetDatabase">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">AcsOds</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{84B1011D-112A-4259-9D7C-9FB47D533D6C}"
      DTS:ObjectName="TargetServer">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">QSQL104NTV</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{230FC61A-DF1B-42DB-9F7F-DF9EAF61957C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FormatFileRepository">
      <DTS:VariableValue
        DTS:DataType="8">ODS_FormatFiles</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3D84A114-7425-44BD-9C8B-392D9EA057B3}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OdsPostingGroupAuditId">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CAEC58A9-4E37-4E79-AF95-A1402B8BFDF1}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OdsPostingGroupId">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 1"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{FF6B140B-452E-424B-8AA4-58E05259B97F}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{D0BB4D73-F168-4084-9057-A30549F622EB}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{209E601A-4F86-41EE-9A6D-9EF3380441D8}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C65A138F-20BF-4F12-AA2C-A89F8845A784}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{2D91823F-02C5-41DD-9AE1-DF8AE1ECF50E}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">1</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{D7EEF7B1-E455-49F3-98B8-809ABBEB621A}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{7E074EEF-697B-4D73-9917-0CBBB504DA02}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{0C237541-3E6F-4A15-A0F4-4EF9069C1B8E}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{224779F0-0B35-4893-A5F9-A94C98A94A8A}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{5DB31D05-2FC5-4DAC-A35F-779FF167946D}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{5B6F68E5-CFE3-432C-91D9-FA5E30C71225}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1EA3480D-0935-4A2A-B1F1-C6780E5578C7}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{78DCB614-0A42-4065-B4BD-49C9722A9DE1}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{2645AEE2-5052-4D0B-BBEF-39DD1FA140B8}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{91F58BB9-DD7A-4B77-8C05-5F1D5DAB4336}"
            DTS:ObjectName="{91F58BB9-DD7A-4B77-8C05-5F1D5DAB4336}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{72B11974-0D38-4BEE-9AD3-737FA140CDE4}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{9A44CEA7-451B-4C32-8AF3-1DD16E57DA01}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{9EA4AD12-C3E1-46CC-AAAF-E2E4185A8FB8}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{B5B971B7-AF50-4531-B9EA-83335CCA7CA6}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA;&#x9;,[ExtractDate] = GETDATE()&#xA;&#x9;,[ExtractRowCount] = @RowCount &#xA;&#x9;,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{EC78A227-3D1D-4C76-81B8-D5EF7D6CCDA9}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{0D474B4D-AC11-4D90-A0A7-2BA9AAD015E9}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{E0FC5A7C-543B-4BA2-AEE5-AA514A7906A6}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1&amp;&amp; @[User::FullLoadStatus]==0)?True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @PostingGroupAuditId INT=?&#xA;&#x9;&#x9;,@ProcessId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@RowCountControl INT=?&#xA;&#x9;&#x9;,@TotalRecordsInSource BIGINT=?&#xA;&#x9;&#x9;,@ProcessAuditId INT;&#xA;&#xA;SELECT TOP 1 @ProcessAuditId = ProcessAuditId &#xA;FROM [adm].[ProcessAudit]&#xA;WHERE ProcessId = @ProcessId&#xA;AND PostingGroupAuditId = @PostingGroupAuditId&#xA;AND Status = 'I';&#xA;&#xA;IF @ProcessAuditId IS NULL&#xA;AND (@DataExtractTypeId IN(1,2)OR (@DataExtractTypeId = 0 AND @FullLoadStatus = 0))&#xA;INSERT INTO adm.ProcessAudit WITH (TABLOCKX)(&#xA;&#x9; PostingGroupAuditId&#xA;&#x9;,ProcessId&#xA;&#x9;,Status&#xA;&#x9;,TotalRecordsInSource &#xA;&#x9;,ControlRowCount&#xA;&#x9;,CreateDate&#xA;&#x9;,LastChangeDate)&#xA;OUTPUT INSERTED.ProcessAuditId&#xA;VALUES (@PostingGroupAuditId,@ProcessId,'S',@TotalRecordsInSource,@RowCountControl,GETDATE(),GETDATE())&#xA;ELSE &#xA;SELECT ISNULL(@ProcessAuditId,-1);"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="User::FullLoadStatus"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{1E63A226-0D9D-47EF-8788-7F9247DE21CA}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Set Load Type"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @FullLoadStatus INT &#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@CustomerId INT = ?;&#xA;&#xA;IF EXISTS(SELECT TOP 1 PA.ProcessId&#xA;FROM adm.ProcessAudit PA&#xA;INNER JOIN adm.PostingGroupAudit PGA&#xA;&#x9;ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId &#xA;&#x9;AND PGA.CustomerId = @CustomerId &#xA;WHERE PA.ProcessId = @ProcessId&#xA;&#x9;AND PGA.DataExtractTypeId = 0&#xA;&#x9;AND PA.Status = 'FI')&#xA;SET @FullLoadStatus = 1&#xA;ELSE SET @FullLoadStatus = 0&#xA;&#xA;SELECT @FullLoadStatus"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ScriptTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Script Task"
                      DTS:DTSID="{1b330420-bfcb-44b8-9d9c-c42ff3994243}"
                      DTS:ExecutableType="Microsoft.ScriptTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <ScriptProject
                          Name="ST_344c151c8691428092ae7ce179b64640"
                          VSTAMajorVersion="14"
                          VSTAMinorVersion="0"
                          Language="VisualBasic" />
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{53D1668E-531F-40F0-B8B8-BF73697B64BB}"
                      DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint 2]"
                      DTS:CreationName=""
                      DTS:DTSID="{C3A1CEF5-968D-47BD-9306-071B50A3F8FE}"
                      DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint 2"
                      DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery = &#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId IN(0,2))OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#xA;&#x9; EXEC (@SQLQuery);&#xA;&#x9; SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{A73E6159-2246-4A2C-A8CE-D6914C7B80C0}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==0 &amp;&amp; @[User::FullLoadStatus]==1)||(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{40956C16-BC8D-452E-B0CB-6775F71B756D}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{8AC18774-C4C0-48C2-87F6-2EE58E49F0D7}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{E4711A06-CAE7-4D75-A54D-E29E9852D107}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0 OR (@DataExtractTypeId = 2 AND @FullLoadStatus = 0))&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;IF (@returnstatus = 0)&#xA;BEGIN&#xA;IF (@DataExtractTypeId = 2 AND @FullLoadStatus = 0)&#xA;&#x9;SET @DataExtractTypeId = 0&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId;&#xA;END&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{e5655fc6-c0ff-4ad5-b225-0a145e600c38}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{0a01a8b7-67ee-4453-b15a-4e2c1ed49e5e}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{de78d427-ab7e-4820-a00a-669a2bef3e80}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{26b7a736-d576-4de8-bc26-a03172967a84}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@returnstatus INT = ?;&#xA;&#x9;&#x9;&#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::OnError"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{9BC909C3-D555-482D-8B76-2DBCA51EB55F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==0&amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2&amp;&amp; @[User::FullLoadStatus]==0)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{B6E023BC-610C-4927-A4B0-F871F13EF1D7}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{BE6E0778-B1BE-4F61-9D79-D5461FB76E2F}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{17181C9E-9139-44D2-88BD-E7138E5A9014}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId IN (0,2)&#xA;BEGIN&#xA;&#x9;UPDATE [adm].[ProcessAudit]&#xA;&#x9;SET  [Status] = 'FI'&#xA;&#x9; ,[LastUpdateDate] = GETDATE()&#xA;&#x9; ,[LastChangeDate] = GETDATE()&#xA;&#x9;WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@TargetNameExtension VARCHAR(100) = ''&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@returnstatus INT = ?;&#xA;&#x9;&#x9;&#xA;-- Create index to match target table&#x9;&#x9;&#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OnError"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{5AD4BFBF-04E6-4350-83DF-EDB243FF8758}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{F1AD672C-FE17-4AED-8EF7-12C020FC9C84}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{B0324AA3-49B6-4550-BF2F-18555E704236}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{0B0A8855-5B59-4336-A099-B1C757FA74F3}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{C272E5FF-A1D8-44C7-BA3C-82F590A417D2}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ScriptTask"
                  DTS:Description="Script Task"
                  DTS:DTSID="{49cea706-1d02-4327-9212-6f3fd6309994}"
                  DTS:ExecutableType="Microsoft.ScriptTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <ScriptProject
                      Name="ST_ed2a334c508644529f9b4439bae6d3ab"
                      VSTAMajorVersion="14"
                      VSTAMinorVersion="0"
                      Language="VisualBasic" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{6577D4D7-2D7D-4E65-81F8-63098E3D2C26}"
              DTS:ObjectName="{6577D4D7-2D7D-4E65-81F8-63098E3D2C26}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{3E1AD879-C9CF-480C-88E3-5565B14E4E17}"
              DTS:ObjectName="{3E1AD879-C9CF-480C-88E3-5565B14E4E17}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{DF9D3FA7-F6CA-4158-9E20-4AEAAF451E43}"
              DTS:ObjectName="{DF9D3FA7-F6CA-4158-9E20-4AEAAF451E43}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{E6326968-5C9D-4282-AA9D-ADB534575A45}"
              DTS:ObjectName="{E6326968-5C9D-4282-AA9D-ADB534575A45}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{D3E7E223-82BB-4D5A-AE07-7CFBB5FC1442}"
              DTS:ObjectName="{D3E7E223-82BB-4D5A-AE07-7CFBB5FC1442}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::TotalRecordsInSource" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{1BD7BF49-960F-4648-98DB-B20B3AEB3281}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{AAC0397E-5DB1-4BE5-9213-1AA0B86C1281}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{57274d31-9034-4473-a73f-7e91e24cedab}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 1"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@LoadGroup INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT  = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = CASE WHEN @DataExtractTypeId = 2  THEN P.LoadGroup ELSE @LoadGroup END&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 2"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{41334b0b-b36b-4e5f-a1e9-47a89aed9ced}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 2">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{dfad4b09-73a1-4c1b-8793-1356aa19e553}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{828f6ff8-ce34-4bd2-a33f-50c28f369cfb}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{fdbca6a8-d17a-4974-b83a-98f25af2be31}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1c1a26a7-fdce-45b8-8011-404bf9ddfd04}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">2</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{6999823a-4a4f-4687-b55d-f8f62527b29f}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{3389eee1-8c3a-4895-a57f-f9e218f3c3c8}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{713a9388-9787-4466-b63b-27786a0594b3}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{DDAAEA65-D5BB-489F-B5E4-2E14759F4AF5}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{f32a5316-7902-44da-8e82-d87e52580595}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{ba92605d-7999-4832-9523-623bbcd0e7f7}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{37afbae4-0663-4179-887f-a08b283d1c09}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C2CAF31B-96A1-454D-8F94-9E29F4508E5B}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:PropertyExpression
        DTS:Name="Disable">@[$Package::DataExtractTypeId] == 2 ? True : False</DTS:PropertyExpression>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{6e986443-7f67-416a-8923-0f1d5f2b03ef}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{717d415c-bde2-4166-a351-c460bd9047f6}"
            DTS:ObjectName="{91F58BB9-DD7A-4B77-8C05-5F1D5DAB4336}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{c415bb41-6683-4370-932e-9fbf826541a7}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{92b8c3b6-802b-4cf4-b68b-cf180d0c9c8f}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{d193869d-2f25-4ced-8c68-b4bb2cf0aefd}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{0620a4b2-477e-4fda-97aa-35a3384745d4}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA; ,[ExtractDate] = GETDATE()&#xA; ,[ExtractRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{7100e62a-3981-4ece-8abf-ba115e2a3318}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{ca0b5b7c-c90f-4780-96ae-b10ffd9fc63a}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{2c24b695-06b5-47cb-96c7-e1fec6d0cd0c}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1&amp;&amp; @[User::FullLoadStatus]==0)?True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @PostingGroupAuditId INT=?&#xA;  ,@ProcessId INT=?&#xA;  ,@FullLoadStatus INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@RowCountControl INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?&#xA;  ,@ProcessAuditId INT;&#xA;&#xA;SELECT TOP 1 @ProcessAuditId = ProcessAuditId &#xA;FROM [adm].[ProcessAudit]&#xA;WHERE ProcessId = @ProcessId&#xA;AND PostingGroupAuditId = @PostingGroupAuditId&#xA;AND Status = 'I';&#xA;&#xA;IF @ProcessAuditId IS NULL&#xA;AND (@DataExtractTypeId IN(1,2)OR (@DataExtractTypeId = 0 AND @FullLoadStatus = 0))&#xA;INSERT INTO adm.ProcessAudit WITH (TABLOCKX)(&#xA;  PostingGroupAuditId&#xA; ,ProcessId&#xA; ,Status&#xA; ,TotalRecordsInSource &#xA; ,ControlRowCount&#xA; ,CreateDate&#xA; ,LastChangeDate)&#xA;OUTPUT INSERTED.ProcessAuditId&#xA;VALUES (@PostingGroupAuditId,@ProcessId,'S',@TotalRecordsInSource,@RowCountControl,GETDATE(),GETDATE())&#xA;ELSE &#xA;SELECT ISNULL(@ProcessAuditId,-1);"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="User::FullLoadStatus"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{efdbc393-1d51-4cb0-902c-e7086b04859d}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Set Load Type"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @FullLoadStatus INT &#xA;  ,@ProcessId INT = ?&#xA;  ,@CustomerId INT = ?;&#xA;&#xA;IF EXISTS(SELECT TOP 1 PA.ProcessId&#xA;FROM adm.ProcessAudit PA&#xA;INNER JOIN adm.PostingGroupAudit PGA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId &#xA; AND PGA.CustomerId = @CustomerId &#xA;WHERE PA.ProcessId = @ProcessId&#xA; AND PGA.DataExtractTypeId = 0&#xA; AND PA.Status = 'FI')&#xA;SET @FullLoadStatus = 1&#xA;ELSE SET @FullLoadStatus = 0&#xA;&#xA;SELECT @FullLoadStatus"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ScriptTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Script Task"
                      DTS:DTSID="{1e7fbbd7-e941-402c-b7b1-e65987d287f8}"
                      DTS:ExecutableType="Microsoft.ScriptTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <ScriptProject
                          Name="ST_08e4250b05964e5f89174422a0a46c2f"
                          VSTAMajorVersion="14"
                          VSTAMinorVersion="0"
                          Language="VisualBasic" />
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{4BA51268-9C7A-4DB5-93B1-B5AC5A72F89F}"
                      DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint 2]"
                      DTS:CreationName=""
                      DTS:DTSID="{06cd9b89-293d-420f-96f9-c148bd0bf710}"
                      DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint 2"
                      DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;  ,@FormatFileRepository VARCHAR(255) = ?&#xA;  ,@DataFileName VARCHAR(255) = ?&#xA;  ,@CustomerDatabase VARCHAR(100) = ?&#xA;  ,@TargetTableName VARCHAR(255) = ?&#xA;  ,@OdsVersion VARCHAR(20) = ?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@FullLoadStatus INT=?&#xA;  ,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery = &#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;'IF EXISTS (&#xA;   SELECT object_id&#xA;   FROM sys.indexes&#xA;   WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;    AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging &#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#xA;  EXEC (@SQLQuery);&#xA;  SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{43263321-5cf5-4e7b-9977-725c62b73a1f}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==0 &amp;&amp; @[User::FullLoadStatus]==1)||(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{b05b678b-f4b9-498a-ac13-e7760c9f87db}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{8339ba5e-f5ba-4afa-9e7a-481d9a43296d}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{f0985fec-d0a9-4d78-ae12-296c67c19776}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;IF (@returnstatus = 0)  &#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{1cbc5a73-5882-450d-ab95-e2ecd2620f0c}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{633f5cb3-8e73-4878-85c7-c0b9ab76c46f}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{6534f5d9-0911-4858-86e9-f1792ea012bb}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{7ea868cb-08e2-4e5b-995d-4171b9d9a989}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@returnstatus INT = ?;&#xA;  &#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::OnError"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{3705f679-76dd-448c-85e9-0e488469e740}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==0&amp;&amp; @[User::FullLoadStatus]==0)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{edfa8b21-dce9-4dc5-8ba4-e58d2ee5595e}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{e5c498e5-d364-4cb4-b25b-9bee18800cac}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{2872efb1-5cd7-405e-b2ab-4111c1a5358c}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA; UPDATE [adm].[ProcessAudit]&#xA; SET  [Status] = 'FI'&#xA;  ,[LastUpdateDate] = GETDATE()&#xA;  ,[LastChangeDate] = GETDATE()&#xA; WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@TargetNameExtension VARCHAR(100) = ''&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT = ?;&#xA;  &#xA;-- Create index to match target table  &#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OnError"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{ae129d7c-4132-4557-8b7b-c39f3c89454b}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{7a64de38-fc62-4f87-bb7e-cbe574c4f0a4}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{a37fd5f9-b286-4470-836b-6b8ccbaa84ea}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{be024471-e044-4287-9bfa-f19fb65f4614}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{611e221c-9a11-4150-80a3-d2d5cf3633b7}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ScriptTask"
                  DTS:Description="Script Task"
                  DTS:DTSID="{2e63ea5b-5192-4df6-8cbb-72052f391c4a}"
                  DTS:ExecutableType="Microsoft.ScriptTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <ScriptProject
                      Name="ST_6bfbfaefa03b447ba5ec899f32830b89"
                      VSTAMajorVersion="14"
                      VSTAMinorVersion="0"
                      Language="VisualBasic" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{145EB2CB-81E6-4F84-B220-7438BE61082C}"
              DTS:ObjectName="{145EB2CB-81E6-4F84-B220-7438BE61082C}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{ED0F67B2-485E-4F47-A0F2-2C252D03B077}"
              DTS:ObjectName="{ED0F67B2-485E-4F47-A0F2-2C252D03B077}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{1F2083DE-9150-4AA6-9858-9C681F9D7EC7}"
              DTS:ObjectName="{1F2083DE-9150-4AA6-9858-9C681F9D7EC7}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{408C4852-C165-438B-BBC3-2FD3EEFC95FD}"
              DTS:ObjectName="{408C4852-C165-438B-BBC3-2FD3EEFC95FD}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{BB5B573A-74DE-483F-A8D1-FAC1328309A9}"
              DTS:ObjectName="{BB5B573A-74DE-483F-A8D1-FAC1328309A9}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::TotalRecordsInSource" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{bf0b7895-32a1-4bee-a153-f78d1100de5a}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{5da3dbc4-b9dc-4ba8-975d-c1329e26756c}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{fe7e1e7b-323b-49db-b1b8-f7f5f3e3aadf}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 2"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@CustomerDatabase VARCHAR(100)=?&#xA;  ,@LoadGroup INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = @LoadGroup&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;&#xA;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 3"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{692b21de-c8b6-4be8-b63f-bce157c890a7}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 3">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{ae344786-8fde-4ac1-8ab4-eda95835b4ed}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{8b9db8a3-8403-4881-856f-f8133fee2a16}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{646a41eb-24c1-48ff-82b8-892764da9807}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{28fa127b-8bca-4182-888d-9faa5a79dcd4}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">3</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{4e5208da-4844-46b3-9451-26f76361dc1e}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{727d0cd6-e481-41a3-8ec3-809cf39cc115}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{cb8c7a8a-6936-4024-bc86-cd42ac26ecfd}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{B737213E-CF77-4710-A4C8-0E33E5E20ADC}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{2d665ae2-12b5-49f6-b6db-314887c1c610}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{c96c5f49-65aa-430e-9a24-87a4fa94292f}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{928b0e33-b214-48f2-93e2-1caaace7f4f4}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{7D7671C3-4F0C-4E24-8050-2EFF0F55BE3A}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:PropertyExpression
        DTS:Name="Disable">@[$Package::DataExtractTypeId] == 2 ? True : False</DTS:PropertyExpression>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{62d4b2b7-64b4-454d-a721-53feae4ee234}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{381b52bb-8bc3-4d9b-8552-1d8f2c71ebd0}"
            DTS:ObjectName="{91F58BB9-DD7A-4B77-8C05-5F1D5DAB4336}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{27756b83-af79-4231-80c9-c192b9d83ff5}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{ae446775-99ee-4312-9d4e-b33be10e1409}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{02082f49-3c87-4a16-9342-dce117de87e5}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{39c7945e-3f6c-4b56-b359-65ca272ef42a}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA; ,[ExtractDate] = GETDATE()&#xA; ,[ExtractRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{49a8e949-8fa7-42e8-8f9f-b83b0740c02c}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{522b96ea-5d6c-41af-8a81-1cdc2d4de0f5}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{9ba0b106-f5b2-4297-986c-3568ac86a1ee}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1&amp;&amp; @[User::FullLoadStatus]==0)?True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @PostingGroupAuditId INT=?&#xA;  ,@ProcessId INT=?&#xA;  ,@FullLoadStatus INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@RowCountControl INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?&#xA;  ,@ProcessAuditId INT;&#xA;&#xA;SELECT TOP 1 @ProcessAuditId = ProcessAuditId &#xA;FROM [adm].[ProcessAudit]&#xA;WHERE ProcessId = @ProcessId&#xA;AND PostingGroupAuditId = @PostingGroupAuditId&#xA;AND Status = 'I';&#xA;&#xA;IF @ProcessAuditId IS NULL&#xA;AND (@DataExtractTypeId IN(1,2)OR (@DataExtractTypeId = 0 AND @FullLoadStatus = 0))&#xA;INSERT INTO adm.ProcessAudit WITH (TABLOCKX)(&#xA;  PostingGroupAuditId&#xA; ,ProcessId&#xA; ,Status&#xA; ,TotalRecordsInSource &#xA; ,ControlRowCount&#xA; ,CreateDate&#xA; ,LastChangeDate)&#xA;OUTPUT INSERTED.ProcessAuditId&#xA;VALUES (@PostingGroupAuditId,@ProcessId,'S',@TotalRecordsInSource,@RowCountControl,GETDATE(),GETDATE())&#xA;ELSE &#xA;SELECT ISNULL(@ProcessAuditId,-1);"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="User::FullLoadStatus"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{93a2fcba-9be2-4773-b57a-78a6086edd74}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Set Load Type"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @FullLoadStatus INT &#xA;  ,@ProcessId INT = ?&#xA;  ,@CustomerId INT = ?;&#xA;&#xA;IF EXISTS(SELECT TOP 1 PA.ProcessId&#xA;FROM adm.ProcessAudit PA&#xA;INNER JOIN adm.PostingGroupAudit PGA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId &#xA; AND PGA.CustomerId = @CustomerId &#xA;WHERE PA.ProcessId = @ProcessId&#xA; AND PGA.DataExtractTypeId = 0&#xA; AND PA.Status = 'FI')&#xA;SET @FullLoadStatus = 1&#xA;ELSE SET @FullLoadStatus = 0&#xA;&#xA;SELECT @FullLoadStatus"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ScriptTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Script Task"
                      DTS:DTSID="{be7667c2-2a0d-4a02-84b6-c2e409f248d0}"
                      DTS:ExecutableType="Microsoft.ScriptTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <ScriptProject
                          Name="ST_46f273935b4f45ffad4d5a8a4144f654"
                          VSTAMajorVersion="14"
                          VSTAMinorVersion="0"
                          Language="VisualBasic" />
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{9DE0E2E0-0094-4340-8433-1A13894D4879}"
                      DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint 2]"
                      DTS:CreationName=""
                      DTS:DTSID="{40c27395-d7f7-45f5-8dc5-ace46d4c2626}"
                      DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint 2"
                      DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;  ,@FormatFileRepository VARCHAR(255) = ?&#xA;  ,@DataFileName VARCHAR(255) = ?&#xA;  ,@CustomerDatabase VARCHAR(100) = ?&#xA;  ,@TargetTableName VARCHAR(255) = ?&#xA;  ,@OdsVersion VARCHAR(20) = ?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@FullLoadStatus INT=?&#xA;  ,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery = &#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;'IF EXISTS (&#xA;   SELECT object_id&#xA;   FROM sys.indexes&#xA;   WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;    AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging &#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#xA;  EXEC (@SQLQuery);&#xA;  SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{281f49ef-9078-40d5-8790-22b173c03665}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==0 &amp;&amp; @[User::FullLoadStatus]==1)||(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{ec9e7c18-531b-4dfe-960a-98c4396bd30e}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{7e98e893-be5c-44fd-b263-6e69bf87aff6}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{8c7a856a-4ffc-4b9b-beb4-620defcd0e30}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;IF (@returnstatus = 0)  &#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{c4e20fbd-6d21-49ed-9ff9-51f24da4e0b3}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{e82fb16f-94ff-470b-8ea8-3d3726bd072b}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{bd819925-7820-4d4a-ae52-a970ba39f786}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{65067629-c9ac-4f1a-b449-6710966b6cc8}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@returnstatus INT = ?;&#xA;  &#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::OnError"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{aab59252-21c3-4f1e-9742-1666445470be}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==0&amp;&amp; @[User::FullLoadStatus]==0)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{35246a44-07df-41ad-b46d-ed0fc988c922}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{b6ef751b-cced-45cd-adec-c3f7609c4159}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{2bbaa6c7-0090-4ad2-ac17-885211e99d09}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA; UPDATE [adm].[ProcessAudit]&#xA; SET  [Status] = 'FI'&#xA;  ,[LastUpdateDate] = GETDATE()&#xA;  ,[LastChangeDate] = GETDATE()&#xA; WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@TargetNameExtension VARCHAR(100) = ''&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT = ?;&#xA;  &#xA;-- Create index to match target table  &#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OnError"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{b76f1201-663f-45e7-853b-55acda540dfb}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{22d5e735-0232-4a8e-82ca-cd4c03adbd92}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{e533b7de-2daf-4919-ac75-81b0d5b4c690}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{b2124a69-74db-4e3f-95ce-b3f1d05cb14c}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{7dec2606-eee8-423e-be1e-8d5029ee6e33}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ScriptTask"
                  DTS:Description="Script Task"
                  DTS:DTSID="{0e58eb26-21d9-417e-b7d9-659e73d840f9}"
                  DTS:ExecutableType="Microsoft.ScriptTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <ScriptProject
                      Name="ST_7328c66666ee41d887ff40f7c9ddefc4"
                      VSTAMajorVersion="14"
                      VSTAMinorVersion="0"
                      Language="VisualBasic" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{B556F6D2-AA5F-4D42-977D-D5464113CDB3}"
              DTS:ObjectName="{B556F6D2-AA5F-4D42-977D-D5464113CDB3}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{7EEDA1E7-AA13-412B-B29B-338787004AA7}"
              DTS:ObjectName="{7EEDA1E7-AA13-412B-B29B-338787004AA7}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{832BA370-A80A-414C-9A07-706F72B347EB}"
              DTS:ObjectName="{832BA370-A80A-414C-9A07-706F72B347EB}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{698ED3B2-3EFE-4434-9FD0-2AD473A156EF}"
              DTS:ObjectName="{698ED3B2-3EFE-4434-9FD0-2AD473A156EF}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{0656D16A-ED58-418E-B81B-4E2060664629}"
              DTS:ObjectName="{0656D16A-ED58-418E-B81B-4E2060664629}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::TotalRecordsInSource" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{53bdcb5d-f794-4015-ae2e-062147ec733a}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{918adc55-d1db-46ee-8d56-6df75ff74de1}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{1101d0b8-e3e2-4799-8de9-07288eb72264}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 3"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@CustomerDatabase VARCHAR(100)=?&#xA;  ,@LoadGroup INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = @LoadGroup&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;&#xA;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPostExecute]"
      DTS:CreationName="OnPostExecute"
      DTS:DTSID="{840893B1-42C9-433B-8712-AAB4F0ED7A10}"
      DTS:EventID="98684680"
      DTS:EventName="OnPostExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{6A961A6C-A583-47F3-9C88-CD9C39034A06}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPostExecute]\Update All Processes In Single Transaction"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{65652340-2B05-4950-ABD6-143AD6CB9867}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update All Processes In Single Transaction"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[System::SourceName] !=  @[System::PackageName]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
              SQLTask:SqlStatementSource="DECLARE @CustomerId INT=?,&#xA;&#x9;&#x9;@SnapshotDate VARCHAR(50)=?,&#xA;&#x9;&#x9;@OdsPostingGroupAuditId INT=?;&#xA;&#xA;EXEC  adm.Etl_UpdateTargetColumnsWithStaging @CustomerId,@SnapshotDate,@OdsPostingGroupAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::CustomerId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="$Package::SnapshotDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPreExecute]"
      DTS:CreationName="OnPreExecute"
      DTS:DTSID="{0972E63E-F5A2-4A70-B01E-018434C6AD95}"
      DTS:EventID="253369764"
      DTS:EventName="OnPreExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{34D805CC-1C40-4AEC-A886-6A9F3C273EAC}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPreExecute]\Generate PostingGroupAuditId"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:DelayValidation="True"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{96eb110e-1cab-45ba-aef2-b2beb682805f}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Generate PostingGroupAuditId"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[System::SourceName] !=  @[System::PackageName]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{2C7287A1-FD4E-44D9-8DAE-41BAED593423}"
              SQLTask:SqlStatementSource="DECLARE &#x9; @OltpPostingGroupAuditId INT=?&#xA;&#x9;&#x9;,@PostingGroupId INT=?&#xA;&#x9;&#x9;,@CustomerId INT=?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20)=?&#xA;&#x9;&#x9;,@SnapshotCreateDate VARCHAR(100)=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#xA;EXEC adm.Etl_GetPostingGroupAuditId @OltpPostingGroupAuditId,@PostingGroupId,@CustomerId,@OdsVersion,@SnapshotCreateDate,@DataExtractTypeId;"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::OdsPostingGroupAuditId" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::OltpPostingGroupAudutId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::OdsPostingGroupId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="$Package::CustomerId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="$Package::OdsVersion"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="$Package::SnapshotDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="5"
                SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="255,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="252,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="135,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="135.75,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="136.25,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 1"
          TopLeft="30,16.3333333333342" />
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="256,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="256,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="136,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="136,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="137.5,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 2"
          TopLeft="427,16" />
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="257,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="252,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="135,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="136.25,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="136.75,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 3"
          TopLeft="832,13" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="281,42"
          Id="Package.EventHandlers[OnPostExecute]\Update All Processes In Single Transaction"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="224,42"
          Id="Package.EventHandlers[OnPreExecute]\Generate PostingGroupAuditId"
          TopLeft="22,206" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="204,42"
          Id="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="182,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="197,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="38,225" />
        <NodeLayout
          Size="148,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
          TopLeft="55,40" />
        <NodeLayout
          Size="182,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="49,132" />
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="138.25,174">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,51"
              Start="0,0"
              End="0,43.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,43.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint 2]"
          TopLeft="129,82">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="11,50"
              Start="0,0"
              End="11,42.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21" />
                  <mssgle:CubicBezierSegment
                    Point1="0,21"
                    Point2="0,25"
                    Point3="4,25" />
                  <mssgle:LineSegment
                    End="7,25" />
                  <mssgle:CubicBezierSegment
                    Point1="7,25"
                    Point2="11,25"
                    Point3="11,29" />
                  <mssgle:LineSegment
                    End="11,42.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="182,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="197,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="46,231" />
        <NodeLayout
          Size="148,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
          TopLeft="55,40" />
        <NodeLayout
          Size="182,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="49,132" />
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="142.25,174">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,57"
              Start="0,0"
              End="0,49.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint 2]"
          TopLeft="129,82">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="11,50"
              Start="0,0"
              End="11,42.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21" />
                  <mssgle:CubicBezierSegment
                    Point1="0,21"
                    Point2="0,25"
                    Point3="4,25" />
                  <mssgle:LineSegment
                    End="7,25" />
                  <mssgle:CubicBezierSegment
                    Point1="7,25"
                    Point2="11,25"
                    Point3="11,29" />
                  <mssgle:LineSegment
                    End="11,42.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="182,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="197,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="58,247" />
        <NodeLayout
          Size="148,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Set Load Type"
          TopLeft="55,40" />
        <NodeLayout
          Size="182,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="49,132" />
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="140,174">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="16.5,73"
              Start="0,0"
              End="16.5,65.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,32.5"
                    Point2="0,36.5"
                    Point3="4,36.5" />
                  <mssgle:LineSegment
                    End="12.5,36.5" />
                  <mssgle:CubicBezierSegment
                    Point1="12.5,36.5"
                    Point2="16.5,36.5"
                    Point3="16.5,40.5" />
                  <mssgle:LineSegment
                    End="16.5,65.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint 2]"
          TopLeft="129,82">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="11,50"
              Start="0,0"
              End="11,42.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21" />
                  <mssgle:CubicBezierSegment
                    Point1="0,21"
                    Point2="0,25"
                    Point3="4,25" />
                  <mssgle:LineSegment
                    End="7,25" />
                  <mssgle:CubicBezierSegment
                    Point1="7,25"
                    Point2="11,25"
                    Point3="11,29" />
                  <mssgle:LineSegment
                    End="11,42.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>