<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/15/2016 12:05:21 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="TB101541"
  DTS:CreatorName="CORP\tb101541"
  DTS:DelayValidation="True"
  DTS:DTSID="{1DF5C65F-AAE4-41B2-8D78-FED0906EFE3B}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.68"
  DTS:LocaleID="1033"
  DTS:MaxConcurrentExecutables="100"
  DTS:ObjectName="DP_ODSLoad_Processes"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="586"
  DTS:VersionGUID="{AF3D1B60-9553-408E-B3A8-AB85026FAD80}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[Target]"
      DTS:CreationName="OLEDB"
      DTS:DelayValidation="True"
      DTS:DTSID="{9FCC17AD-999B-4873-B538-94AEA836439D}"
      DTS:ObjectName="Target">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Package::TargetDatabase]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Package::TargetServer]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=DSQL112V\ANLITXETLDEV2;Initial Catalog=Wcsods;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{1904232D-3987-4458-9B52-B78EE1AF6A55}"
      DTS:ObjectName="CoreDBVersionId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{6A5A5C42-D3CC-4DFA-98F7-EBC32297A7EB}"
      DTS:ObjectName="CustomerDatabase">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">ODS_dB_1_Child</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{3FDC57CA-91A1-44B0-9C9B-1A65FC53877D}"
      DTS:ObjectName="CustomerId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{B52FBDFF-061B-495B-995A-BEBDF20327A2}"
      DTS:ObjectName="DataExtractTypeId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{C3524A68-8358-4F55-A2F1-E8A4596B1306}"
      DTS:ObjectName="DataRepositoryPath">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">\\MEDPD-DELL20\OdsFileExtractsDev\SmartAdvisor\</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{6C70342D-DD0C-4A80-87BF-80C0720C035C}"
      DTS:ObjectName="OdsVersion">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">1.0.0.0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{0D74486E-A953-4CEB-807E-4F140098992F}"
      DTS:ObjectName="OltpPostingGroupAudutId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{B20858B3-775F-4BBB-8407-598F2F0AA7B7}"
      DTS:ObjectName="SnapshotDate">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">1900-01-01 00:00:00.000</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{076BECC4-F8B7-4640-B942-7AE262B97D23}"
      DTS:ObjectName="TargetDatabase">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">Wcsods</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{762D4F35-3E51-4BD4-99D9-C05584F86085}"
      DTS:ObjectName="TargetServer">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">DSQL112V\ANLITXETLDEV2</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{ECB46378-BB63-4046-A694-51F51A3AC207}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FormatFileRepository">
      <DTS:VariableValue
        DTS:DataType="8">ODS_FormatFiles</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{66698EB2-9BA1-4C84-9DAB-56135C80C326}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="LatestCoreDBVersionId">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{ED0E183A-4D60-41BB-9377-98E07F2E023A}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OdsPostingGroupAuditId">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4061AF79-ED0C-474E-94FF-D49AF0AFF4F9}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OdsPostingGroupId">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 1"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{D7B36E05-6354-4AF4-8E4C-36911DF6C2FE}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{0D4BDDC8-D2B0-41ED-96AA-539F279CE7A3}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{CD22A985-B9F3-47CD-BAD3-1B3EFD96ED7F}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{FB433016-7258-4254-B73D-DC5A48D21075}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{B338FDEA-2C63-4A19-8647-C6B84E417F87}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="IsSnapshot">
          <DTS:VariableValue
            DTS:DataType="11">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{849793CD-1917-4276-BA6A-01BBCCC76A60}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">1</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{6881F7E3-BBBC-4EDE-9427-2802119909B7}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{9B7C7958-4537-4095-8807-43FEDCB58084}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{B7E10659-A516-4B01-956A-3B67CFA2F476}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{4EC0CAF4-AC36-45FC-8A5A-0773B37AFD40}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="ProductKey">
          <DTS:VariableValue
            DTS:DataType="8">SmartAdvisor</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{132C2C61-1B19-4657-94BA-00363FD968C4}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{35418DA2-5A09-4F48-8D38-3139F9AD6EAF}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{295C6CA9-3F02-4D32-A0C4-6A3755B3EA6A}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{03EC4998-C500-4E5E-8D53-E04DB703D8F8}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{0ED4D4AD-9DAB-4869-B272-E18C91B05D90}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{93695C78-97A4-4102-A35F-F7C56DE2DDBF}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{C80B2FCD-36DC-40A5-A9CD-B4892BE1C0AA}"
            DTS:ObjectName="{C80B2FCD-36DC-40A5-A9CD-B4892BE1C0AA}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{DCC14853-546B-4516-BECA-1CEA049787D1}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{519BB84B-D212-4427-8C95-39474B232575}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{AE2A098E-1723-4E9F-A935-B8BD6EDA6AB7}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{6C45C33E-5EFB-41B1-9EC6-483E197B5A83}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA;&#x9;,[ExtractDate] = GETDATE()&#xA;&#x9;,[ExtractRowCount] = @RowCount &#xA;&#x9;,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{2FAAC778-1523-45ED-A341-135E302DB56E}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{481C9C0B-19C0-429F-A043-5343343C33C9}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{f36aada3-1471-4cab-8a77-e98bcd097560}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessId INT=?&#xA;  ,@ControlRowCount INT=?&#xA;  ,@CustomerId INT=?&#xA;  ,@IsSnapshot INT=?&#xA;  ,@PostingGroupAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?;&#xA;&#xA;EXEC adm.Etl_GetProcessAuditId @ProcessId,@ControlRowCount,@TotalRecordsInSource,@CustomerId,@IsSnapshot,@PostingGroupAuditId,@DataExtractTypeId"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="1"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="User::IsSnapshot"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="6"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{fe89551b-0b21-4c22-8c95-9e0a85baaf9d}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="SELECT 0 AS OnError"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::OnError" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{DAA21B07-DD9B-4E1F-B484-1465C3AA71A2}"
                      DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@LatestCoreDBVersionId INT=?&#xA;&#x9;&#x9;,@IsSnapshot INT=?&#xA;&#x9;&#x9;,@ProductKey VARCHAR(100)=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery=&#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'&#xA;EXEC (@SQLQuery);&#xA;&#xA;SET @SQLQuery = &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;&#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@ProductKey+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#x9;&#xA;&#x9;EXEC (@SQLQuery);&#xA;&#x9;SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE IF (@FullLoadStatus=1 AND @DataExtractTypeId=0)&#xA;&#x9;SELECT 0&#xA;ELSE &#xA;&#x9;SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="8"
                    SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="9"
                    SQLTask:DtsVariableName="User::LatestCoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="10"
                    SQLTask:DtsVariableName="User::IsSnapshot"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="11"
                    SQLTask:DtsVariableName="User::ProductKey"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{FE9624FD-8AE4-4077-83DA-F28FF9EC2796}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)||(@[User::OnError] ==1)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{F5727EC4-1D1D-4F02-916D-E9D9D00B8A1F}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{5D8BE5D1-BE81-4990-AAA0-DFAFE68C7CAC}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{457222E4-AD90-40F1-BA18-08F7B5B4FCA0}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@RowsAffected INT = -1&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus;&#xA;&#xA;IF (@returnstatus = 0)&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId,@RowsAffected = @RowsAffected OUTPUT, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @RowsAffected,@returnstatus;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="1"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{5C0C3447-175C-4B84-AA70-D2613E57667F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{7601512C-2C2B-48AF-A9AC-1664DD2B021D}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{6354CD97-73DC-4592-A6B2-6FBAAAE4ECF8}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{DD51CE23-E76A-406C-8A6B-7E23CAB2BBA6}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@returnstatus INT;&#xA;&#x9;&#x9;&#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{4D8A9A13-3B0F-4888-BD0E-5270CA5109F2}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId]==0)||(@[User::OnError] ==1)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{87067D45-C985-4211-9D95-807783F0B44E}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{505D0743-1F02-4504-B435-40018C318AB6}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{35F39AAB-8D74-476D-889D-DC6547FA6940}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA;&#x9;UPDATE [adm].[ProcessAudit]&#xA;&#x9;SET  [Status] = 'U'&#xA;&#x9; ,[LastUpdateDate] = GETDATE()&#xA;&#x9; ,[LastChangeDate] = GETDATE()&#xA;&#x9;WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@TargetNameExtension VARCHAR(100) = ''&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@returnstatus INT;&#xA;&#x9;&#x9;&#xA;-- Create index to match target table&#x9;&#x9;&#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{3EDA9057-E0EF-49FE-8C95-3BAA60FECA76}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{63A3F307-CD15-4130-A518-D3C3A2B11167}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{4CDD3069-344C-478C-BA8D-CBD6F1119BFC}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{EFB4E1AB-5450-47EB-BBF0-A2BF1E5E3925}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{44BF0923-1AAD-46CF-8A60-6DABB161AF1E}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{38945316-7A45-4321-BB71-22944FB60270}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                      SQLTask:SqlStatementSource="SELECT 1 AS OnError"
                      SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ResultBinding
                        SQLTask:ResultName="0"
                        SQLTask:DtsVariableName="User::OnError" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{49D0B96E-F072-4FC9-88E2-3F1A48270F03}"
              DTS:ObjectName="{49D0B96E-F072-4FC9-88E2-3F1A48270F03}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{A0A25540-0561-410E-8EB8-9E5AA5EB9A70}"
              DTS:ObjectName="{A0A25540-0561-410E-8EB8-9E5AA5EB9A70}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{81289CA7-76DA-43C0-A4DC-62A7B476F9AB}"
              DTS:ObjectName="{81289CA7-76DA-43C0-A4DC-62A7B476F9AB}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{73F02B7C-46B9-4AFA-8EEB-58838A6637B5}"
              DTS:ObjectName="{73F02B7C-46B9-4AFA-8EEB-58838A6637B5}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::IsSnapshot" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{362F29C5-67DE-4F16-AD8D-E9FBB6A9AA7D}"
              DTS:ObjectName="{362F29C5-67DE-4F16-AD8D-E9FBB6A9AA7D}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{1DEE0C7A-CC9A-41F7-89B6-E58CEDBC3691}"
              DTS:ObjectName="{1DEE0C7A-CC9A-41F7-89B6-E58CEDBC3691}"
              DTS:ValueIndex="5"
              DTS:VariableName="User::TotalRecordsInSource" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{BE4EADAE-B7D6-41EC-9B4F-2F94FA72DAEF}"
              DTS:ObjectName="{BE4EADAE-B7D6-41EC-9B4F-2F94FA72DAEF}"
              DTS:ValueIndex="6"
              DTS:VariableName="User::ProductKey" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{5323A0AD-100F-4DAF-ACF8-040BC902E80E}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{60CF9AF2-3D57-420E-A02F-634D33EC2DF5}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{6035922E-60C5-4DAD-9C84-2C5B18D3D6EA}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 1"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@LoadGroup INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT  = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,P.IsSnapshot&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA;&#x9;,P.ProductKey&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I','U')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = CASE WHEN @DataExtractTypeId = 2  THEN P.LoadGroup ELSE @LoadGroup END&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 2"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{32CDD0EA-470F-4298-A781-7B2DA1EDB467}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 2">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{17A67C6D-DDEF-487C-A15C-8F5C8377AC25}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{EC3D3CBE-0F31-44A7-9641-2674870F6410}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1A1EDF40-C12A-43C2-8BC4-98F6229B57B8}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{67B3EC91-DFF9-4C6F-B0A5-D5A94D11D8A6}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="IsSnapshot">
          <DTS:VariableValue
            DTS:DataType="11">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C13A7457-AC3A-4BCC-A0BA-FC39C0B885C0}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">2</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{F31A8DE5-16B3-4F0D-AA19-50CFE85E9461}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{DDBCA25B-B6FA-40A4-813B-7EE4B961D98A}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{AB988665-2C9E-47EF-A7C4-A6E586F39280}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{8F1673C9-887A-4E4D-988B-7EC0A3003530}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="ProductKey">
          <DTS:VariableValue
            DTS:DataType="8">SmartAdvisor</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{BE8885EC-61C9-4032-BD39-B69DCD7D52FC}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{CD536480-934A-4D29-BFA9-C77E863173D7}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{CC009F3B-C2DD-4EA8-9AB1-14364FD44234}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{4552CC0D-54A2-4795-B2B7-EF5E4CE183DF}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{98051C74-D57C-41FE-BC36-7B4023762894}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:PropertyExpression
        DTS:Name="Disable">@[$Package::DataExtractTypeId] == 2 ? True : False</DTS:PropertyExpression>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{1678BE37-8E40-4BE2-88BE-96CA47268E0D}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{BCBE8D0D-7B99-402C-9BAF-2A47D45FE1A9}"
            DTS:ObjectName="{C80B2FCD-36DC-40A5-A9CD-B4892BE1C0AA}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{B62B1E2C-B318-48DE-AA6B-7E98FBFEF69E}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{C2263851-FD6C-4955-91FA-1CEEA4FA944F}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{5891EC54-40F0-4C4A-AE0C-6725AFB595B9}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{F81D99C3-449D-4933-BE36-751B82DB57B0}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA; ,[ExtractDate] = GETDATE()&#xA; ,[ExtractRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{C679EDEB-47B1-4254-A764-B53D4FD007B8}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{15B02F1C-A718-42D6-A93D-729086498CF8}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{13fd48f4-fb94-4a72-b50e-70ac480495fe}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessId INT=?&#xA;  ,@ControlRowCount INT=?&#xA;  ,@CustomerId INT=?&#xA;  ,@IsSnapshot INT=?&#xA;  ,@PostingGroupAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?;&#xA;&#xA;EXEC adm.Etl_GetProcessAuditId @ProcessId,@ControlRowCount,@TotalRecordsInSource,@CustomerId,@IsSnapshot,@PostingGroupAuditId,@DataExtractTypeId"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="1"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="User::IsSnapshot"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="6"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{1f6203da-53b2-46a5-81b5-7eb5732c2db9}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="SELECT 0 AS OnError"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::OnError" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{05000891-044A-476C-8360-022682F35882}"
                      DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@LatestCoreDBVersionId INT=?&#xA;&#x9;&#x9;,@IsSnapshot INT=?&#xA;&#x9;&#x9;,@ProductKey VARCHAR(100)=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery=&#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'&#xA;EXEC (@SQLQuery);&#xA;&#xA;SET @SQLQuery = &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;&#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@ProductKey+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#x9;&#xA;&#x9;EXEC (@SQLQuery);&#xA;&#x9;SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE IF (@FullLoadStatus=1 AND @DataExtractTypeId=0)&#xA;&#x9;SELECT 0&#xA;ELSE &#xA;&#x9;SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="8"
                    SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="9"
                    SQLTask:DtsVariableName="User::LatestCoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="10"
                    SQLTask:DtsVariableName="User::IsSnapshot"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="11"
                    SQLTask:DtsVariableName="User::ProductKey"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{83DBA166-E438-44A3-99A4-C10A2940ACBC}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)||(@[User::OnError] ==1)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{F4EDDDA1-4EB8-4B43-B01B-7055627040AA}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{9BBFA465-6ECB-4849-A3F0-1157F96786EA}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{F6A26194-577E-4672-9C2B-4162371AEE73}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@RowsAffected INT = -1&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus;&#xA;&#xA;IF (@returnstatus = 0)&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId,@RowsAffected = @RowsAffected OUTPUT, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @RowsAffected,@returnstatus;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="1"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{A1C32B0D-B967-48BE-80E7-27189C23B1FB}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{D327EA63-DBE4-497C-823E-28D344EE9F8D}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{BF2DC5C8-B704-4CBF-9124-CC5347AE732A}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{A1029472-3E32-4FC2-AA44-443E8069A58B}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@returnstatus INT;&#xA;  &#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{CE8604FC-AB06-492C-BD29-308A86960A1E}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId]==0)||(@[User::OnError] ==1)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{3CDECF82-C7A4-40C5-B32C-1731BC1DC321}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{0898A2C9-7E4A-47DB-A0A5-5BD0E818EF7E}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{53F3A515-270A-48CA-9A98-BF37B565D825}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA; UPDATE [adm].[ProcessAudit]&#xA; SET  [Status] = 'U'&#xA;  ,[LastUpdateDate] = GETDATE()&#xA;  ,[LastChangeDate] = GETDATE()&#xA; WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@TargetNameExtension VARCHAR(100) = ''&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT;&#xA;  &#xA;-- Create index to match target table  &#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{06A6169F-E80D-48C5-BC79-471AC9C0A8CC}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{8E38A1C4-4274-4B98-9505-8274803B65AC}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{E563FC7F-1859-420C-A290-91A5D744D9A9}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{418E0A37-9518-4704-88EC-0C94797DA94D}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{035A664A-770D-4A1F-81CE-F4C1B6B29134}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{f08965a7-8793-4d25-9ee8-d9ddba71832b}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                      SQLTask:SqlStatementSource="SELECT 1 AS OnError"
                      SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ResultBinding
                        SQLTask:ResultName="0"
                        SQLTask:DtsVariableName="User::OnError" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{8D521655-177E-4A55-BAB8-C838AAC13DCF}"
              DTS:ObjectName="{8D521655-177E-4A55-BAB8-C838AAC13DCF}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{32721F00-8276-41FB-8F0A-D5371BA38199}"
              DTS:ObjectName="{32721F00-8276-41FB-8F0A-D5371BA38199}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{9DE8FB5F-4D1B-4F89-8FD8-1FBEA2CCE836}"
              DTS:ObjectName="{9DE8FB5F-4D1B-4F89-8FD8-1FBEA2CCE836}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{89D26116-4976-4639-BC3E-A8330E3F2173}"
              DTS:ObjectName="{89D26116-4976-4639-BC3E-A8330E3F2173}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::IsSnapshot" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{19461EC9-912A-4066-955A-0BC33D68616A}"
              DTS:ObjectName="{19461EC9-912A-4066-955A-0BC33D68616A}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{61F624E3-7003-4D19-85A9-9E96E3F88C8A}"
              DTS:ObjectName="{61F624E3-7003-4D19-85A9-9E96E3F88C8A}"
              DTS:ValueIndex="5"
              DTS:VariableName="User::TotalRecordsInSource" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{7A97C597-B697-45E0-8C11-E7342F82B0F8}"
              DTS:ObjectName="{7A97C597-B697-45E0-8C11-E7342F82B0F8}"
              DTS:ValueIndex="6"
              DTS:VariableName="User::ProductKey" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{17426F60-B072-4020-AD79-5C7C69982368}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{4F727F59-D9D0-4B3D-A8F6-ABD6D529B1EE}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{B468BE81-9EAF-4C57-B14B-AEFDDF691ADD}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 2"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@CustomerDatabase VARCHAR(100)=?&#xA;  ,@LoadGroup INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,P.IsSnapshot&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA;&#x9;,P.ProductKey&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I','U')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = @LoadGroup&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;&#xA;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 3"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{86B233CE-1B0F-40AB-8FC7-EFB08FF9CDFC}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 3">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{E1110CE1-E06D-4BB8-B044-BC88AE89DA27}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{5EC16EA0-9457-4FA6-9A3B-ACA685F91C11}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{51BF9803-7EFC-4F0F-B2F7-6BFEE20F10D3}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{58043D05-CF89-48C6-9AA1-33838BD1D620}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="IsSnapshot">
          <DTS:VariableValue
            DTS:DataType="11">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{A0ED7B8E-1257-4F41-80C4-ABD0A7E890DD}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">3</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{6522E926-70AC-4F60-BA68-C1D204AE49CF}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{460CB81A-68DD-4632-9F95-5A90464F97BB}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{F7264E28-2A99-4114-A3EE-7A557DB535CC}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{7A302CA4-D96F-4696-B83C-CFDBA2F9934A}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="ProductKey">
          <DTS:VariableValue
            DTS:DataType="8">SmartAdvisor</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{41DC15BE-E2A7-49ED-BBFC-B4F436FC1B07}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{B4FB672A-C45E-4366-9026-C423A16DFDD7}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{A03856D6-6830-4549-8AA3-CDB31AFC7638}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{8F2F042E-F613-4E3E-A4F9-937B980D3856}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{138852F3-7925-45C0-B69D-0EA85DD28D18}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:PropertyExpression
        DTS:Name="Disable">@[$Package::DataExtractTypeId] == 2 ? True : False</DTS:PropertyExpression>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{C78A1A1F-34EA-4FFC-8DAB-15863E847358}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{A1557873-E0BC-40B1-A191-80815FE9A8A2}"
            DTS:ObjectName="{C80B2FCD-36DC-40A5-A9CD-B4892BE1C0AA}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{748614D4-DD63-4CCE-A33F-E07220F0E9FD}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{C2CC98FA-80BF-45AA-A5C8-DF49C05D1AA3}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{367DF017-84A7-42E4-8E64-39FC74EFDFC1}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{DA429FAC-FA0E-4BC4-B28D-7B8D3CF02F1C}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA; ,[ExtractDate] = GETDATE()&#xA; ,[ExtractRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{BF685197-B452-40FA-BD20-6CDF457077A5}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{78935E6A-EC21-443E-8044-AFCC40ACFDDA}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{06d68678-7b26-4073-8955-6b6d650efaf5}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessId INT=?&#xA;  ,@ControlRowCount INT=?&#xA;  ,@CustomerId INT=?&#xA;  ,@IsSnapshot INT=?&#xA;  ,@PostingGroupAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?;&#xA;&#xA;EXEC adm.Etl_GetProcessAuditId @ProcessId,@ControlRowCount,@TotalRecordsInSource,@CustomerId,@IsSnapshot,@PostingGroupAuditId,@DataExtractTypeId"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="1"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="User::IsSnapshot"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="6"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{9ca34ff5-a5f9-4060-81dd-41069ed1a9bb}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="SELECT 0 AS OnError"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::OnError" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{4A39A95E-E893-44E0-823C-D3B77B941F24}"
                      DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@LatestCoreDBVersionId INT=?&#xA;&#x9;&#x9;,@IsSnapshot INT=?&#xA;&#x9;&#x9;,@ProductKey VARCHAR(100)=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery=&#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'&#xA;EXEC (@SQLQuery);&#xA;&#xA;SET @SQLQuery = &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;&#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@ProductKey+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#x9;&#xA;&#x9;EXEC (@SQLQuery);&#xA;&#x9;SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE IF (@FullLoadStatus=1 AND @DataExtractTypeId=0)&#xA;&#x9;SELECT 0&#xA;ELSE &#xA;&#x9;SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="8"
                    SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="9"
                    SQLTask:DtsVariableName="User::LatestCoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="10"
                    SQLTask:DtsVariableName="User::IsSnapshot"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="11"
                    SQLTask:DtsVariableName="User::ProductKey"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{09A9646A-6550-4DB5-9500-4A9378C579EC}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)||(@[User::OnError] ==1)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{A37805D4-DD39-4710-A9D5-F613D33A9AA0}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{73DCA17A-AFE5-4467-94CD-C65111AE4FD4}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{6384DE3E-A8C8-40B5-B4C4-6E5B9C2C76D0}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@RowsAffected INT = -1&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus;&#xA;&#xA;IF (@returnstatus = 0)&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId,@RowsAffected = @RowsAffected OUTPUT, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @RowsAffected,@returnstatus;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="1"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{FA85DAE5-1C62-4A68-B014-936C14B248E6}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{0B981760-91E7-4033-B6D9-6DEF9A7FEBBF}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{62EA8FB9-A53A-4495-BF17-AA76E42FE18D}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{3B2B81CE-146E-4026-91BC-FFBA3BD9B445}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@returnstatus INT;&#xA;  &#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{C2EF26E5-9A06-47DD-8CF1-655DF06CA11F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId]==0)||(@[User::OnError] ==1)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{ACD8FB8B-511F-4E44-8542-9834A4AB17E7}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{553405BC-B2A7-4587-B0C2-AC6A191F2B44}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{C149439E-7B22-4B9B-B923-431D989944FD}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA; UPDATE [adm].[ProcessAudit]&#xA; SET  [Status] = 'U'&#xA;  ,[LastUpdateDate] = GETDATE()&#xA;  ,[LastChangeDate] = GETDATE()&#xA; WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@TargetNameExtension VARCHAR(100) = ''&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT;&#xA;  &#xA;-- Create index to match target table  &#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{B22711E6-25AB-497D-9634-6CB51C3B391A}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{46D326E5-EEA3-4086-874B-466DD5F0DF01}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{4CFF9DD8-C6F5-4E63-9672-0E2F837642F0}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{11D1F9D7-E990-405D-B934-15B21879F057}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{658028E5-DE45-4DA7-95AC-49D39CBCF23E}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{edbe60a7-3b8c-4ab9-bf23-f8f0578757c4}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                      SQLTask:SqlStatementSource="SELECT 1 AS OnError"
                      SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ResultBinding
                        SQLTask:ResultName="0"
                        SQLTask:DtsVariableName="User::OnError" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{3795B2D9-2C4F-4852-A0E8-FE4D3D09FB3F}"
              DTS:ObjectName="{3795B2D9-2C4F-4852-A0E8-FE4D3D09FB3F}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{E7B46162-67E9-4031-95AF-8E74D1F9B01D}"
              DTS:ObjectName="{E7B46162-67E9-4031-95AF-8E74D1F9B01D}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{121CA496-5DF8-4922-A787-4DF3C4393C7A}"
              DTS:ObjectName="{121CA496-5DF8-4922-A787-4DF3C4393C7A}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{B2F15696-F034-4A88-8699-82E1C56E93EF}"
              DTS:ObjectName="{B2F15696-F034-4A88-8699-82E1C56E93EF}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::IsSnapshot" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{AECD2174-F04C-407F-869C-8C770C7A5106}"
              DTS:ObjectName="{AECD2174-F04C-407F-869C-8C770C7A5106}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{2D2B3C8C-7D47-448D-933B-2B628931027F}"
              DTS:ObjectName="{2D2B3C8C-7D47-448D-933B-2B628931027F}"
              DTS:ValueIndex="5"
              DTS:VariableName="User::TotalRecordsInSource" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{0A55964A-BEBB-4F66-9E19-3756AC2BAB2F}"
              DTS:ObjectName="{0A55964A-BEBB-4F66-9E19-3756AC2BAB2F}"
              DTS:ValueIndex="6"
              DTS:VariableName="User::ProductKey" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{C8DE9C24-602D-4ED4-8773-C1556E694106}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{C78653F4-0649-4B33-BE25-933112684ACF}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{BBAAC0B3-2F79-4DA2-8620-A9C189026BD0}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 3"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@CustomerDatabase VARCHAR(100)=?&#xA;  ,@LoadGroup INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,P.IsSnapshot&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA;&#x9;,P.ProductKey&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I','U')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = @LoadGroup&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;&#xA;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPostExecute]"
      DTS:CreationName="OnPostExecute"
      DTS:DTSID="{4A6E4018-7173-40C9-901B-6643B832CFFC}"
      DTS:EventID="98684680"
      DTS:EventName="OnPostExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{0A23A5F0-2BE9-4D6B-8A49-FC2FAE72AB65}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPostExecute]\Update All Processes In Single Transaction"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{C7202C26-9D36-4B58-9617-CEAD75E1B058}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update All Processes In Single Transaction"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[System::SourceName] !=  @[System::PackageName]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
              SQLTask:SqlStatementSource="DECLARE @CustomerId INT=?,&#xA;&#x9;&#x9;@SnapshotDate VARCHAR(50)=?,&#xA;&#x9;&#x9;@OdsPostingGroupAuditId INT=?;&#xA;&#xA;EXEC  adm.Etl_UpdateTargetColumnsWithStaging @CustomerId,@OdsPostingGroupAuditId,@SnapshotDate" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::CustomerId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="$Package::SnapshotDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPreExecute]"
      DTS:CreationName="OnPreExecute"
      DTS:DTSID="{B4D0E6DA-FC32-415D-9359-DDC20B79BBCA}"
      DTS:EventID="253369764"
      DTS:EventName="OnPreExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{ED6C2DE4-F562-45CF-AF96-9B574365632D}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPreExecute]\Generate PostingGroupAuditId"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:DelayValidation="True"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{19BEBD66-4C42-480B-99E2-36E8A4392D37}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Generate PostingGroupAuditId"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[System::SourceName] !=  @[System::PackageName]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FCC17AD-999B-4873-B538-94AEA836439D}"
              SQLTask:SqlStatementSource="DECLARE  @OltpPostingGroupAuditId INT=?&#xA;&#x9;&#x9;,@PostingGroupId INT=?&#xA;&#x9;&#x9;,@CustomerId INT=?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20)=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@SnapshotCreateDate VARCHAR(100)=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;&#xA;EXEC adm.Etl_GetPostingGroupAuditId @OltpPostingGroupAuditId, @PostingGroupId, @CustomerId, @OdsVersion, @CoreDBVersionId, @SnapshotCreateDate, @DataExtractTypeId"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::OdsPostingGroupAuditId" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="1"
                SQLTask:DtsVariableName="User::LatestCoreDBVersionId" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::OltpPostingGroupAudutId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::OdsPostingGroupId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="$Package::CustomerId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="$Package::OdsVersion"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="5"
                SQLTask:DtsVariableName="$Package::SnapshotDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="6"
                SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="255,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="243,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="132.75,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="135.75,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="134,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 1"
          TopLeft="30,16.3333333333342" />
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="248,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="243,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="132.75,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="134,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="132.25,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="333,316"
          Size="333,359"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,14.6249999955156" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="346,428"
          Size="346,471"
          Id="Package\Process LoadGroup 2"
          TopLeft="427,16" />
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="248,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="243,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="132.75,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="134,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="132.25,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 3"
          TopLeft="830,14" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="280.5,42"
          Id="Package.EventHandlers[OnPostExecute]\Update All Processes In Single Transaction"
          TopLeft="5.5,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPreExecute]\Generate PostingGroupAuditId"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="198.5,42"
          Id="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="5.5,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="24.5,24.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="63,241" />
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="71.5,117.5" />
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="162.875,159.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,81.5"
              Start="0,0"
              End="0,74">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,74" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="191,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="191,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="191,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="204,42"
          Id="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="42.5,32" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="44,212" />
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="40.5,73" />
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="130.75,115">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="14.25,97"
              Start="0,0"
              End="14.25,89.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,44.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,44.5"
                    Point2="0,48.5"
                    Point3="4,48.5" />
                  <mssgle:LineSegment
                    End="10.25,48.5" />
                  <mssgle:CubicBezierSegment
                    Point1="10.25,48.5"
                    Point2="14.25,48.5"
                    Point3="14.25,52.5" />
                  <mssgle:LineSegment
                    End="14.25,89.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="15.5,25" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="60.5,248.5" />
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="62.5,79.5" />
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="152.75,121.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8.75,127"
              Start="0,0"
              End="8.75,119.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,59.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,59.5"
                    Point2="0,63.5"
                    Point3="4,63.5" />
                  <mssgle:LineSegment
                    End="4.75,63.5" />
                  <mssgle:CubicBezierSegment
                    Point1="4.75,63.5"
                    Point2="8.75,63.5"
                    Point3="8.75,67.5" />
                  <mssgle:LineSegment
                    End="8.75,119.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>